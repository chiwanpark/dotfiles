# Zsh configuration
source "$HOME/.config/zsh/slimzsh/slim.zsh"
fpath=("$HOME/.config/zsh/zsh-completions/src" "$HOME/.config/zsh/zfunc" $fpath)

# locale
export LANG=en_US.UTF-8
export LC_ALL=en_US.UTF-8

# Editor configuration
export EDITOR=nvim
alias vi=nvim
alias vim=nvim

# PATH
export PATH="$HOME/.local/bin:$HOME/.cargo/bin:$PATH"

# ls command
export CLICOLOR=1 # for Darwin
ls --color=auto &> /dev/null && alias ls='ls --color=auto'
alias ll='ls -lh'

# ssh proxies
alias proxy-snu='ssh -C2qTnN -D 8111 chiwanpark@mimosa.snu.ac.kr'

# custom commands
alias speedtest-cli='curl -s https://raw.githubusercontent.com/sivel/speedtest-cli/master/speedtest.py | python -'
alias pdf-fontfix='LANG=C LC_ALL=C sed -i s"|/Registry (Adobe) /Ordering (Korea1) /Supplement [0-9]|/Registry(Adobe) /Ordering(Identity) /Supplement 0|g"'
pdf-decrypt() {
    local in="$1"
    local pw="$2"
    if [ -z "$pw" ]; then
        echo -n 'Password: '
        read -s pw
    fi
    echo 'Decrypting...'
    pdftk "$in" input_pw "$pw" output "${in:r}_decrypted.pdf"
}

# fzf
source "$HOME/.config/zsh/fzf.zsh"

if [ -d "$HOME/.local/google-cloud-sdk" ]; then
    source "$HOME/.local/google-cloud-sdk/completion.zsh.inc"
    source "$HOME/.local/google-cloud-sdk/path.zsh.inc"
fi

# rbenv
if [ -x "$(command -v rbenv)" ]; then
    eval "$(rbenv init -)"
fi

# import local zsh confiuration
if [[ -f "$HOME/.config/zsh/zshrc.local" ]]; then
    source "$HOME/.config/zsh/zshrc.local"
fi

# kubectl autocompletion
if [ -x "$(command -v kubectl)" ]; then
    source <(kubectl completion zsh)
fi

# iterm2 integration
test -e "${HOME}/.iterm2_shell_integration.zsh" && source "${HOME}/.iterm2_shell_integration.zsh"
